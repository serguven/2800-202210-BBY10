<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- Local CSS -->
    <link rel="stylesheet" href="./css/admin.css">
    <title>Document</title>
</head>

<body>
    <div id="admin-title">
        <h1>Admin Dashboard</h1>
    </div>
    <form class="d-flex" id="search-bar">
        <input class="form-control me-2 br" type="search" placeholder="Search User" aria-label="Search">
        <button class="btn btn-outline-success br" type="submit">Search</button>
    </form>
    <div id="populate">

    </div>
    <!-- <div class="card br">
        <div class="card-body">
            <div class="card-title d-flex">
                <h3>User information</h3>
            </div>
            <div class="card-text d-flex">
                <label class="me-3">First Name:</label>
                <div id="firstName">firstname</div>
            </div>
            <div class="card-text d-flex">
                <label class="me-3">Last Name:</label>
                <div id="lastName">lastname</div>
            </div>
            <div class="card=text d-flex">
                <label class="me-3">Email:</label>
                <div id="email">email</div>
            </div>
            <div class="card=text d-flex">
                <label class="me-3">Password:</label>
                <div id="password">password</div>
            </div>
            <div class="card=text d-flex">
                <label class="me-3">User Type:</label>
                <div id="userType">usertype</div>
            </div>
            <div class="btn-group d-flex mt-3" role="group" aria-label="Basic mixed styles example">
                <button type="button" class="btn btn-success mx-2" id="action-button">Edit</button>
                <button type="button" class="btn btn-danger mx-2" id="action-button-2">Delete</button>
            </div>
        </div>
    </div> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        ///////////////////////////////////////populate all users to cards //////////////////////////////////////////////////////////////
        // $(document).ready(function () {
        //     $.ajax({
        //         url: "/getAllUsersInfo",
        //         type: "GET",
        //         success: function (data) {
        //             data.forEach(user => {
        //                 var s = `<div class="card br">`
        //                 s += `<div class="card-body">`;
        //                 s += `<div class="card-title d-flex">`;
        //                 s += `<h3>User information</h3>`
        //                 s += `</div>`
        //                 s += `<div class="card-text d-flex">`
        //                 s += `<label class="me-3">First Name:</label>`
        //                 s += `<div id="firstName">${user.firstName}</div>`
        //                 s += `</div>`
        //                 s += `<div class="card-text d-flex">`
        //                 s += `<label class="me-3">Last Name:</label>`
        //                 s += `<div id="lastName">${user.lastName}</div>`
        //                 s += `</div>`
        //                 s += `<div class="card=text d-flex">`
        //                 s += `<label class="me-3">Email:</label>`
        //                 s += `<div id="email">${user.email}</div>`
        //                 s += `</div>`
        //                 s += `<div class="card=text d-flex">`
        //                 s += `<label class="me-3">Password:</label>`
        //                 s += `<div id="password">${user.password}</div>`
        //                 s += `</div>`
        //                 s += `<div class="card=text d-flex">`
        //                 s += `<label class="me-3">User Type:</label>`
        //                 s += `<div id="userType">${user.userType}</div>`
        //                 s += `</div>`
        //                 s += `<div class="btn-group d-flex mt-3" role="group" aria-label="Basic mixed styles example" id="${user._id}">`
        //                 s += `<button type="button" class="btn btn-success mx-2" id="action-button">Edit</button>`
        //                 s += `<button type="button" class="btn btn-danger mx-2" id="action-button-2">Delete</button>`
        //                 s += `</div>`
        //                 s += `</div>`
        //                 s += `</div>`
        //                 $('#populate').append(s);
        //             });

        //         }
        //     })
        // })


        $(document).ready(function () {
            $.ajax({
                url: "/getAllUsersInfo",
                type: "GET",
                success: function (data) {
                    data.forEach(user => {
                        var s = `<div class="card br">`
                        s += `<div class="card-body">`;
                        s += `<div class="card-title d-flex">`;
                        s += `<h3>User information</h3>`
                        s += `</div>`
                        s += `<div class="card-text d-flex">`
                        s += `<label class="me-3">First Name:</label>`
                        s += `<div id="firstName" contentEditable="true">${user.firstName}</div>`
                        s += `</div>`
                        s += `<div class="card-text d-flex">`
                        s += `<label class="me-3">Last Name:</label>`
                        s += `<div id="lastName" contentEditable="true">${user.lastName}</div>`
                        s += `</div>`
                        s += `<div class="card=text d-flex">`
                        s += `<label class="me-3">Email:</label>`
                        s += `<div id="email" contentEditable="true">${user.email}</div>`
                        s += `</div>`
                        s += `<div class="card=text d-flex">`
                        s += `<label class="me-3">Password:</label>`
                        s += `<div id="password" contentEditable="true">${user.password}</div>`
                        s += `</div>`
                        s += `<div class="card=text d-flex">`
                        s += `<label class="me-3">User Type:</label>`
                        s += `<div id="userType" contentEditable="true">${user.userType}</div>`
                        s += `</div>`
                        s += `<div class="btn-group d-flex mt-3" role="group" aria-label="Basic mixed styles example" id="${user._id}">`
                        s += `<button type="button" class="btn btn-success mx-2" id="action-button">Update</button>`
                        s += `<button type="button" class="btn btn-danger mx-2" id="action-button-2">Delete</button>`
                        s += `</div>`
                        s += `</div>`
                        s += `</div>`
                        $('#populate').append(s);
                    });

                }
            })
        })





        //////////////////////////////////////////delete card data //////////////////////////////////////////////////////////
        $(document).on('click', '#action-button-2', function () {
            $.ajax({
                url: '/delete',
                type: 'POST',
                data: {_id: $(this).parent().attr('id')},
                success: function(data) {
                    console.log($(this).parent().attr('id'));
                    location.reload();
                }
            })
        })


        /////////////////////////////////////////////update card data //////////////////////////////////////////////////////////////////
        $(document).on('click', '#action-button', function () {
            $.ajax({
                url: '/adminUpdates',
                type: 'POST',
                data: {
                    _id: $(this).parent().attr('id'),
                    firstName: $(this).parent().prev().prev().prev().prev().prev().children("div").text(),
                    lastName: $(this).parent().prev().prev().prev().prev().children("div").text(),
                    email: $(this).parent().prev().prev().prev().children("div").text(),
                    password: $(this).parent().prev().prev().children("div").text(),
                    userType: $(this).parent().prev().children("div").text(),
                },
                success: function (data) {
                    location.reload();
                }
            })
        })


    </script>
</body>

</html>